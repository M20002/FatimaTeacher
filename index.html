<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>الملف التعريفي | المعلمة فاطمة عوض حسن آل بشير</title>

<!-- Fonts + Icons -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&family=Poppins:wght@500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
/* ===================== THEME: Deep Sand Beige (new shade) ===================== */
:root{
  --bg:#f8f1e7;          /* warmer, deeper beige than before */
  --card:#ffffff;
  --ink:#2a231c;
  --muted:#6f6154;
  --brand:#e7d8c7;       /* NEW primary */
  --brand-2:#d9c6b0;     /* NEW accent */
  --line:#e6d7c5;
  --accent:#f3e8db;
  --brand-ink:#6e4922;   /* headings/buttons */
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--ink);font-family:'Cairo',sans-serif}
html{scroll-behavior:smooth}
a{color:#7a5328;text-decoration:none}
.container{max-width:1100px;margin:0 auto;padding:0 18px}

/* ===================== TOPBAR ===================== */
.topbar{
  position:sticky; top:0; z-index:130;
  background:linear-gradient(180deg, rgba(248,241,231,.92), rgba(248,241,231,.65));
  -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px);
  border-bottom:1px solid var(--line);
}
.topbar .row{display:grid;grid-template-columns:auto 1fr auto;gap:12px;align-items:center;padding:10px 0}
.brand{display:flex;align-items:center;gap:12px;min-width:0;padding:6px 10px;border-radius:14px;background:#fff;border:1px solid var(--line);box-shadow:0 6px 14px rgba(110,73,34,.06)}
.brand .mark{width:40px;height:40px;border-radius:12px;background:linear-gradient(180deg,#fff,#ead9c6);border:1px solid #cfb79b}
.brand .title{display:flex;flex-direction:column;line-height:1.1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.brand .title b{color:var(--brand-ink);font-weight:800}
.brand .title small{color:#7a5328;font-weight:700}
.lang-switch{display:flex;gap:8px;align-items:center}
.lang-switch button,.login-btn,.nav-btn{background:var(--brand);color:var(--brand-ink);border:1px solid #cfbca7;border-radius:12px;padding:8px 12px;font-weight:800;cursor:pointer}
.lang-switch .secondary{background:#fbf3e8;color:#7a5328;border:1px solid var(--line)}
#sectionsBtn{background:#f1e5d6;color:#7a5328;border:1px solid var(--line)}
[data-guard]{display:none}
/* ===================== HERO v6 — Mobile Floral Crest ===================== */
.hero{
  position:relative;
  padding:clamp(28px,6vw,48px) 0 clamp(28px,5vw,44px);
  border-bottom:1px solid var(--line);
  background:
    radial-gradient(600px 340px at 10% -10%, #efe6d7 0%, rgba(239,230,215,0) 60%),
    radial-gradient(600px 340px at 110% 100%, #efe6d7 0%, rgba(239,230,215,0) 60%),
    linear-gradient(180deg,#faf6f0 0%,#f4eee5 70%,#ffffff 100%);
  overflow:hidden;
}

/* subtle linen texture */
.hero::before{
  content:"";
  position:absolute; inset:0; pointer-events:none; opacity:.16;
  background-image:url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'>\
<path d='M0 24h48M24 0v48' stroke='%23e2d6c5' stroke-width='0.7' fill='none'/></svg>");
  background-size:48px 48px;
}

/* floating soft petals (very subtle on mobile) */
.hero::after{
  content:"";
  position:absolute; inset:-12% -20%;
  background:
    url(\"data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 160 160'>\
<g fill='%23eadfce' opacity='.55'>\
<circle cx='22' cy='18' r='5'/><circle cx='130' cy='32' r='4'/>\
<circle cx='70' cy='90' r='6'/><circle cx='136' cy='128' r='5'/>\
</g></svg>\") center/500px no-repeat;
  animation: crestDrift 26s linear infinite;
  pointer-events:none; opacity:.26;
}
@keyframes crestDrift{ from{transform:translateY(0)} to{transform:translateY(-8%)} }

/* layout: single column first */
.hero .wrap{
  position:relative; z-index:1;
  max-width:980px; margin:0 auto; padding:0 16px;
  display:grid; gap:18px; align-items:center; justify-items:center;
}

/* Floral crest + ring */
.hero .crest{
  width:140px; height:140px; border-radius:999px;
  border:1px solid var(--line);
  background:
    radial-gradient(90px 90px at 50% 44%, #fff 0%, #f0e6d9 100%);
  box-shadow:0 10px 24px rgba(94,70,48,.12);
  position:relative; display:grid; place-items:center; overflow:hidden;
}
.hero .crest::after{
  content:"";
  position:absolute; inset:12px; border-radius:999px; pointer-events:none;
  background:
    url(\"data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 220 220'>\
<g fill='none' stroke='%23cdbda8' stroke-width='1.6' opacity='.85'>\
<path d='M36 120c22-34 60-36 88-70'/><path d='M54 136c18-16 32-24 60-44'/></g>\
<g fill='%23e8dac7' opacity='.95'>\
<circle cx='84' cy='52' r='8'/><circle cx='60' cy='90' r='7'/><circle cx='46' cy='126' r='6'/></g></svg>\") center/170px no-repeat;
}

/* Title stack (big, readable, centered) */
.hero-title{
  margin:6px 0 4px;
  text-align:center;
  font-size:clamp(24px,6.2vw,36px);
  color:var(--brand-ink);
  font-weight:900; letter-spacing:.15px;
}
.hero-sub{
  margin:0 0 10px;
  text-align:center;
  font-size:clamp(14px,3.8vw,18px);
  color:#6e5136; font-weight:700; opacity:.96;
}

/* Slim divider */
.hero-divider{
  width:110px; height:6px; border-radius:999px; margin:10px auto 14px;
  background:linear-gradient(90deg,#eadfce,#d8c8b2,#eadfce);
  box-shadow:0 4px 10px rgba(94,70,48,.12);
}

/* CTAs: only two on mobile */
.hero-cta{
  display:flex; gap:10px; flex-wrap:wrap; justify-content:center;
}
.hero .btn{
  background:var(--brand); color:var(--brand-ink);
  border:1px solid #cdbda8; border-radius:12px;
  padding:10px 14px; font-weight:900; cursor:pointer;
}
.hero .btn.secondary{ background:#faf4eb; color:#6e5136; border:1px solid var(--line); }

/* hide anything extra inside hero on narrow screens (we removed chips entirely) */

/* scale up spacing on larger screens */
@media (min-width:760px){
  .hero .wrap{ gap:22px; }
  .hero .crest{ width:160px; height:160px; }
  .hero-title{ font-size:clamp(28px,4.6vw,44px); }
}

/* ===== keep previous hero styles in comments (do not delete) ===== */
/* [HERO v4/v5 rules preserved above or in your file as comments per your request] */

/* ===================== HERO — Rich Beige Floral/Butterfly (more ornaments) ===================== */
/*.hero{
  position:relative;
  padding:clamp(54px,8.8vw,116px) 0  clamp(36px,5.2vw,64px);
  border-bottom:1px solid var(--line);
  background:
    radial-gradient(980px 560px at 10% -12%, #efdeca 0%, rgba(239,222,202,0) 60%),
    radial-gradient(820px 520px at 108% 85%, #ead8c1 0%, rgba(234,216,193,0) 60%),
    linear-gradient(180deg,#f8f1e7 0%,#f5ecdf 70%,#ffffff 100%);
  overflow:hidden;
}
.hero .orn{
  position:absolute; inset:0; pointer-events:none; opacity:.45;
  background-repeat:no-repeat; background-size:contain;
}
.hero .orn.flower-left{
  width:640px;height:640px; top:-140px; inset-inline-start:-140px; opacity:.26;
  background-image:url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500'>\
<defs><linearGradient id='g' x1='0' x2='1'><stop offset='0' stop-color='%23e0c9ac'/><stop offset='1' stop-color='%23f1e2cf'/></linearGradient></defs>\
<g fill='url(%23g)'>\
<circle cx='120' cy='120' r='86'/><circle cx='220' cy='80' r='56'/>\
<circle cx='170' cy='200' r='70'/><circle cx='300' cy='150' r='54'/>\
</g>\
<g fill='none' stroke='%23c6a884' stroke-opacity='.55'>\
<path d='M60 260c80-48 160 48 240 0' stroke-width='8'/>\
<path d='M90 310c60-34 120 34 180 0' stroke-width='6'/>\
</g></svg>");
}
.hero .orn.butter-right{
  width:600px;height:600px; bottom:-140px; inset-inline-end:-140px; opacity:.22;
  background-image:url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500'>\
<g fill='%23e7d3b9' fill-opacity='.9'>\
<path d='M160 270c-40-70 60-120 100-50 14-50 90-52 102 8 14 64-52 100-104 66-26 24-78 22-98-24z'/>\
</g>\
<g stroke='%23bd9f7a' stroke-opacity='.6' fill='none'>\
<path d='M190 310c26-12 52-12 78 0' stroke-width='5'/>\
</g></svg>");
}


/* NEW subtle sprigs across top */

/*.hero .orn.sprigs{
  width:100%; height:200px; top:0; left:0; right:0; opacity:.18;
  background-image:url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 200'>\
<g stroke='%23cfb593' stroke-width='3' fill='none' stroke-opacity='.7'>\
<path d='M20 160c80-60 140-40 220-90 60-38 120-20 180 10 100 50 160-10 240-30 80-20 160 40 220 60 80 24 160 10 200-10'/>\
</g></svg>");
}

.hero-inner{display:grid}
.hero-card{
  max-width:960px;margin:0 auto;text-align:center;
  background:linear-gradient(180deg,#ffffff 0%, #f1e6d8 100%);
  border:1px solid var(--line); border-radius:28px;
  padding:clamp(28px,4vw,46px);
  box-shadow:0 18px 38px rgba(110,73,34,.12);
}
.hero-title{
  margin:0 0 6px;
  font-size:clamp(30px,5.1vw,46px);
  color:var(--brand-ink);font-weight:900;letter-spacing:.15px
}
.hero-sub{
  margin:2px 0 18px;
  font-size:clamp(15px,2.2vw,19px);
  color:#7a5328;font-weight:700;opacity:.95
}
.hero-divider{
  width:140px;height:8px;border-radius:999px;margin:14px auto 22px;
  background:linear-gradient(90deg,#e3d2be, #cfbca7, #e3d2be);
  box-shadow:0 4px 10px rgba(110,73,34,.15)
}
.hero-cta{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
.btn{background:var(--brand);color:var(--brand-ink);border:1px solid #cfbca7;border-radius:12px;padding:10px 14px;font-weight:900;cursor:pointer}
.btn.secondary{background:#fbf3e8;color:#7a5328;border:1px solid var(--line)}
*/
/* ===================== SECTIONS ===================== */
section{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:0 10px 26px rgba(110,73,34,.07);padding:24px;margin:22px auto;scroll-margin-top:90px}
.section-head{display:flex;align-items:center;justify-content:space-between;gap:12px;padding-inline:8px;margin:-4px -6px 12px}
.section-head .title{margin:0;color:#7a5328;display:flex;align-items:center;gap:10px;border-inline-start:6px solid var(--brand-2);padding-inline-start:10px}
.section-head .title i{color:#a98559}
.section-head .actions{display:flex;gap:8px}
.btn.icon{width:34px;height:34px;padding:0;display:inline-flex;align-items:center;justify-content:center;border-radius:10px}
.btn.icon i{font-size:14px}
.lead{font-size:18px;line-height:1.9}*/

/* ===================== MEDIA GRID ===================== */
.media-grid{display:grid;gap:14px;grid-template-columns:repeat(auto-fit,minmax(190px,1fr))}
@media (max-width:560px){.media-grid{grid-template-columns:repeat(auto-fit,minmax(160px,1fr))}}
.media-card{position:relative;background:#fff;border:1px solid var(--line);border-radius:12px;box-shadow:0 6px 18px rgba(110,73,34,.07);overflow:hidden}
.media-thumb{position:relative;width:100%;background:#000;overflow:hidden}
.media-thumb[data-kind="image"]{aspect-ratio:3/2}
.media-thumb[data-kind="video"]{aspect-ratio:16/9}
.media-thumb[data-kind="pdf"]{aspect-ratio:3/2;background:#fff}
.media-thumb img,.media-thumb video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;display:block;cursor:zoom-in;background:#fff}
.media-actions{position:absolute;top:8px;inset-inline-end:8px;display:flex;gap:6px;z-index:2}
.icon-btn{background:rgba(255,255,255,.98);border:1px solid var(--line);border-radius:10px;padding:6px;cursor:pointer}

/* Cards */
.cv-card{background:#fff;border:1px solid var(--line);border-radius:12px;padding:16px}
.cv-card.pale-glow{background:linear-gradient(180deg,#ffffff,#f1e6d8);border-color:#d8c7b2;box-shadow:0 10px 24px rgba(110,73,34,.13),0 1px 0 rgba(255,250,242,.95) inset}

/* Force tidy 2-col on phones for media */
@media (max-width: 600px){
  .media-grid{grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 12px;}
  .media-thumb[data-kind="image"], .media-thumb[data-kind="pdf"]{aspect-ratio: 4/3;}
  .media-thumb[data-kind="video"]{aspect-ratio: 16/9;}
}

/* ===================== SKILLS ===================== */
.skills-grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}
.skill{
  background:linear-gradient(180deg,#ffffff 0%, #f1e6d8 100%);
  border:1px solid var(--line);border-radius:14px;box-shadow:0 8px 20px rgba(110,73,34,.08);
  padding:18px 16px;min-height:150px;display:flex;flex-direction:column;gap:8px;
  transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease;
}
.skill:hover{transform:translateY(-2px);box-shadow:0 14px 26px rgba(110,73,34,.13);border-color:#d9c6b0;background:linear-gradient(180deg,#ffffff 0%, #ead9c6 100%)}
.skill i{
  font-size:20px;color:#7a5328;background:#ead9c6;border:1px solid #e2d2bf;border-radius:10px;padding:8px;line-height:1;
  display:inline-flex;align-items:center;justify-content:center
}
.skill h4{margin:4px 0 0;font-size:18px;color:#7a5328;font-weight:800}
.skill p{margin:0;color:var(--muted);line-height:1.7}

/* ===================== FOOTER ===================== */
footer{background:#e7d8c7;border-top:1px solid var(--line);text-align:center;padding:18px;color:#7a5328;font-weight:800}
footer .en{font-family:'Poppins',sans-serif;font-weight:600;color:#444}

/* ===================== LANGUAGE ===================== */
.lang-ar [data-en], .lang-en [data-ar]{display:none}
.lang-en{direction:ltr;font-family:'Poppins',sans-serif}
.lang-en .section-head .title{border-inline-start:none;border-inline-end:6px solid var(--brand-2);padding-inline-start:0;padding-inline-end:10px}

/* ===================== POPUP & AUTH ===================== */
body.no-scroll{overflow:hidden}
#overlay{position:fixed;inset:0;background:rgba(38,30,22,.64);display:none;align-items:center;justify-content:center;padding:16px;z-index:150;-webkit-backdrop-filter: blur(2px); backdrop-filter: blur(2px)}
#overlay.show{display:flex}
#overlay .win{width:min(980px,96vw);max-height:92vh;background:#fff;border:1px solid var(--line);border-radius:14px;box-shadow:0 24px 60px rgba(0,0,0,.35);display:flex;flex-direction:column;overflow:hidden}
#overlay .toolbar{position:sticky;top:0;display:flex;align-items:center;gap:8px;justify-content:space-between;padding:8px 10px;background:linear-gradient(180deg,#fff,#f1e6d8);border-bottom:1px solid var(--line);z-index:2}
#overlay .toolbar .title{display:flex;align-items:center;gap:10px;font-weight:800;color:#7a5328;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
#overlay .toolbar .actions{display:flex;gap:8px}
#overlay .toolbar .btnx{background:#f1e5d6;border:1px solid var(--line);border-radius:10px;padding:8px 12px;font-weight:800;cursor:pointer}
#overlay .toolbar .btnx[data-action="close"]{background:#d9c6b0;color:#5a3b19;border-color:#cfbca7}
#overlay .content{position:relative;overflow:auto;-webkit-overflow-scrolling:touch;background:#000}
#overlay .content-inner{display:grid;place-items:center;min-height:60vh}
#overlay .content img{max-width:100%;height:auto;display:block}
#overlay .content video{max-width:100%;max-height:84vh;display:block}
#overlay .content iframe{width:100%;height:84vh;border:0;background:#fff}

.modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;z-index:200}
.input{width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:10px}

/* ===================== REVEAL ===================== */
.reveal{opacity:0;transform:translateY(14px) scale(.98);transition:opacity .45s ease, transform .45s ease}
.reveal.show{opacity:1;transform:none}
@media (max-width:680px){
  .topbar .row{grid-template-columns:1fr;row-gap:8px}
  .lang-switch{justify-content:center;flex-wrap:wrap}
  .brand{justify-content:center}
  section{padding:16px;margin:16px auto}
  .lead{font-size:16px;line-height:1.8}
}
section ul{padding-inline-start:1.2em}
section li{list-style:disc inside;line-height:1.9;overflow-wrap:anywhere}
@media (prefers-reduced-motion:reduce){*{animation:none!important;transition:none!important}}
</style>
</head>

<body class="lang-ar">
<!-- ===================== TOPBAR ===================== -->
<div class="topbar" role="navigation">
  <div class="container row">
    <div class="brand" aria-label="Site brand">
      <div class="mark" aria-hidden="true"></div>
      <div class="title">
        <b data-ar>المعلمة فاطمة عوض حسن آل بشير</b>
        <b data-en>Teacher Fatima Awad Hassan Al-Bashir</b>
        <small data-ar></small>
        <small data-en>Science | Elem 4–6, Middle & High</small>
      </div>
    </div>

    <div></div>

    <div class="lang-switch" aria-label="Language and account">
      <button id="sectionsBtn" class="nav-btn" aria-haspopup="true" aria-expanded="false"><i class="fa-solid fa-list"></i> <span data-ar>القائمة</span><span data-en>Sections</span></button>
      <button class="secondary" id="to-ar" aria-label="Arabic">العربية</button>
      <button id="to-en" aria-label="English">English</button>
      <button id="loginBtn" class="login-btn" title="تسجيل الدخول" aria-label="Login"><i class="fa-solid fa-user"></i></button>
      <button id="logoutBtn" class="login-btn" style="display:none" title="تسجيل الخروج" aria-label="Logout"><i class="fa-solid fa-right-from-bracket"></i></button>
    </div>
  </div>
</div>

<!-- ===================== HERO (New with extra ornaments) ===================== 
<header class="hero">
  <div class="orn flower-left" aria-hidden="true"></div>
  <div class="orn butter-right" aria-hidden="true"></div>
  <div class="orn sprigs" aria-hidden="true"></div>

  <div class="container hero-inner">
    <div class="hero-card">
      <h1 class="hero-title" data-ar>المعلمة فاطمة عوض حسن آل بشير</h1>
      <h1 class="hero-title" data-en>Teacher Fatima Awad Hassan Al-Bashir</h1>

      <div class="hero-sub" data-ar>تخصص: فيزياء | تُدرّس العلوم، الأحياء، والكيمياء – ابتدائي (٤–٦) ومتوسط وثانوي</div>
      <div class="hero-sub" data-en>Major: Physics | Teaches Science, Biology & Chemistry — Grades 4–6, Middle & High</div>

      <div class="hero-divider" aria-hidden="true"></div>

      <div class="hero-cta">
        <a class="btn" href="#cv" data-ar><i class="fa-solid fa-id-card"></i> السيرة الذاتية</a>
        <a class="btn" href="#cv" data-en><i class="fa-solid fa-id-card"></i> CV</a>
        <a class="btn secondary" href="#about" data-ar><i class="fa-solid fa-book-open"></i> نبذة</a>
        <a class="btn secondary" href="#about" data-en><i class="fa-solid fa-book-open"></i> About</a>
      </div>
    </div>
  </div>
</header>
-->
<!-- ===================== HERO v6 (new Mobile Floral Crest) ===================== -->
<header class="hero" aria-label="Hero">
  <div class="wrap">
    <div class="crest" aria-hidden="true"></div>

    <h1 class="hero-title" data-ar>المعلمة فاطمة عوض حسن آل بشير</h1>
    <h1 class="hero-title" data-en>Teacher Fatima Awad Hassan Al-Bashir</h1>

    <div class="hero-sub" data-ar>فيزياء — تُدرّس العلوم، الأحياء، والكيمياء (ابتدائي ٤–٦، متوسط، ثانوي)</div>
    <div class="hero-sub" data-en>Physics — teaches Science, Biology & Chemistry (Elem 4–6, Middle & High)</div>

    <div class="hero-divider" aria-hidden="true"></div>

    <div class="hero-cta">
      <a class="btn" href="#cv" data-ar><i class="fa-solid fa-id-card"></i> السيرة الذاتية</a>
      <a class="btn" href="#about" data-ar><i class="fa-solid fa-book-open"></i> نبذة</a>

      <a class="btn" href="#cv" data-en><i class="fa-solid fa-id-card"></i> CV</a>
      <a class="btn" href="#about" data-en><i class="fa-solid fa-book-open"></i> About</a>
    </div>
  </div>
</header>

<!--
===================== PREVIOUS HERO kept by request =====================
<header class="hero"> ... your older hero markup (v4/v5) ... </header>
-->

<!-- ===================== MAIN ===================== -->
<main class="container">

<!-- ===== About (stronger copy) ===== -->
<section id="about" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-book-open"></i><span data-ar>نبذة تعريفية</span><span data-en>About</span></h3>
  </div>
  <p class="lead" data-ar>
    أُحول <b>العلوم</b>  إلى حكايات مُلهِمة وتجارب آمنة قصيرة: تبدأ بظاهرة قريبة من حياة الطالبة،
    ثم تُطلق أسئلة ذكية، ففرضيات، فاختبار سريع، فقراءة بيانات ورسمة بسيطة تُقود إلى استنتاج واضح.
    بهذا الإيقاع اللطيف، تُنمي الفضول والجرأة على التفكير، وتُراعي الفروق الفردية بخطوات صغيرة ثابتة.
  </p>
  <p class="lead" data-en>
    <b>Fatima</b> turns science into safe, memorable mini-experiences: start with a real-life phenomenon,
    ask smart questions, form a hypothesis, run a quick test, read the data, and sketch a simple model.
    This gentle rhythm grows curiosity and confidence while honoring differences.
  </p>
</section>

<!-- ===== Vision ===== -->
<section id="vision" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-eye"></i><span data-ar>الرؤية</span><span data-en>Vision</span></h3>
  </div>
  <p class="lead" data-ar>متعلمات فضوليات يفسرن الظواهر علميًا ويستخدمن البيانات لاتخاذ قرارات مسؤولة في حياتهن اليومية.</p>
  <p class="lead" data-en>Curious learners who explain phenomena scientifically and use data to make responsible everyday decisions.</p>
</section>

<!-- ===== Objectives (course/teaching objectives) ===== -->
<section id="objectives" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-list-check"></i><span data-ar>الأهداف التعليمية</span><span data-en>Objectives</span></h3>
  </div>
  <ul>
    <li data-ar>بناء نماذج تفسيرية لظواهر في الفيزياء والأحياء والكيمياء.</li>
    <li data-ar>اكتساب مهارات المختبر الآمن وقراءة البيانات والرسم العلمي.</li>
    <li data-ar>تعزيز الكتابة العلمية والعرض الشفهي المدعوم بالأدلة.</li>
    <li data-ar>حل المشكلات بتجارب قصيرة وخطط تحسين سريعة.</li>

    <li data-en>Model explanations in physics, biology, and chemistry.</li>
    <li data-en>Lab safety, data reading, and scientific sketching.</li>
    <li data-en>Scientific writing and evidence-based presentations.</li>
    <li data-en>Problem solving via short experiments & quick improvements.</li>
  </ul>
</section>

<!-- ===== Saudi Teaching Goals (explicit) ===== -->
<section id="ksa-goals" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-flag"></i><span data-ar>أهداف التعليم في السعودية</span><span data-en>Saudi Teaching Goals</span></h3>
  </div>
  <ul>
    <li data-ar>تعزيز الثقافة العلمية والهوية الوطنية والمسؤولية الرقمية.</li>
    <li data-ar>مهارات القرن ٢١: التفكير النقدي، التواصل، التعاون، الإبداع.</li>
    <li data-ar>تعلم قائم على الاستقصاء والمشروعات وتحسين النواتج.</li>

    <li data-en>Scientific literacy, identity, and digital responsibility.</li>
    <li data-en>21st-century skills: critical thinking, communication, collaboration, creativity.</li>
    <li data-en>Inquiry/project-based learning with measurable outcomes.</li>
  </ul>
</section>

<!-- ===== Mission ===== -->
<section id="mission" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-bullseye"></i><span data-ar>الرسالة</span><span data-en>Mission</span></h3>
  </div>
  <p class="lead" data-ar>
    تمكين الطالبة من استخدام طرق العلم (سؤال–فرضية–تجريب آمن–تحليل–استنتاج) وبناء ثقة معرفية تتسع خطوة بخطوة.
  </p>
  <p class="lead" data-en>
    Enable learners to use the practices of science—questioning, hypothesizing, safe testing, analysis, and conclusion—while building steady confidence.
  </p>
</section>

<!-- ===== Professional Charter ===== -->
<section id="ethics" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-scale-balanced"></i><span data-ar>الميثاق المهني والقيم</span><span data-en>Professional Charter</span></h3>
  </div>

  <div class="cv-card pale-glow">
    <h4 data-ar>القيم</h4><h4 data-en>Values</h4>
    <ul>
      <li data-ar>السلامة والانضباط العلمي والصدق الأكاديمي.</li>
      <li data-ar>الإنصاف وتمايز التعلم واحترام التنوع.</li>
      <li data-ar>التعلم المستمر وعقلية النمو.</li>

      <li data-en>Safety, rigor, and academic honesty.</li>
      <li data-en>Equity, differentiation, and respect for diversity.</li>
      <li data-en>Continuous learning and a growth mindset.</li>
    </ul>
  </div>
</section>

<!-- ===== CV (now includes Certifications bullets) ===== -->
<section id="cv" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-id-card"></i><span data-ar>السيرة الذاتية</span><span data-en>Curriculum Vitae</span></h3>
    <div class="actions" data-guard>
      <label for="cvImgInput" class="btn icon" title="رفع صورة للسيرة (اختياري)"><i class="fa-solid fa-image"></i></label>
      <input id="cvImgInput" type="file" accept="image/*" hidden>
    </div>
  </div>

  <div class="cv-card pale-glow" style="margin-bottom:14px">
    <h4 style="margin-top:0;color:#7a5328">البيانات</h4>
    <ul style="margin:0">
      <li>الاسم: <b>فاطمة عوض حسن آل بشير</b></li>
      <li>التخصص: <b>فيزياء</b> (تُدرّس: علوم، أحياء، كيمياء)</li>
      <li>المراحل: <b>ابتدائي (٤–٦) – متوسط – ثانوي</b></li>
      <li>الهاتف: <a href="tel:0530864335">0530864335</a></li>
      <li>البريد: <a href="mailto:Fwd3046@gmail.com">Fwd3046@gmail.com</a></li>
    </ul>
  </div>

  <div class="cv-card pale-glow">
    <h4 style="margin-top:0;color:#7a5328">التعليم</h4>
    <ul>
      <li data-ar>بكالوريوس <b>فيزياء</b>.</li>
      <li data-en><b>BSc in Physics</b>.</li>
    </ul>

    <h4 style="color:#7a5328">الخبرات</h4>
    <ul>
      <li data-ar>تجارب صفية مصغّرة آمنة تبني المفهوم خطوة بخطوة.</li>
      <li data-ar>تقارير علمية موجزة وعروض مدعومة بالبيانات.</li>

      <li data-en>Safe micro-labs that build concepts gradually.</li>
      <li data-en>Concise reports and data-backed presentations.</li>
    </ul>

    <h4 style="color:#7a5328">المهارات</h4>
    <ul>
      <li data-ar>تفسير الظواهر | كتابة التقارير | العرض العلمي.</li>
      <li data-ar>إدارة المختبر | تقويم بنائي | روبركات واضحة.</li>

      <li data-en>Phenomena modeling | Scientific writing | Presenting.</li>
      <li data-en>Lab management | Formative assessment | Clear rubrics.</li>
    </ul>

    <h4 style="color:#7a5328">الشهادات</h4>
    <ul>
      <li data-ar>سلامة المختبر والإسعافات الأولية.</li>
      <li data-ar>استراتيجيات STEM وتكامل العلوم.</li>
      <li data-ar>تقويم الأداء العلمي وإدارة المشاريع الصفية.</li>

      <li data-en>Lab safety & first aid.</li>
      <li data-en>STEM strategies & integrative science.</li>
      <li data-en>Performance assessment & classroom projects.</li>
    </ul>
  </div>

  <!-- Optional CV image holder -->
  <div id="cvImgHolder" class="cv-card" style="display:none;padding:0;overflow:hidden"></div>
</section>

<!-- ===== NOTE: Old "Certifications (Text)" section is intentionally kept as comments per your request =====
<section id="certs-text" class="reveal">
  ... (REMOVED FROM VIEW — content moved into CV) ...
</section>
-->

<!-- ===== Certification Media (images + PDFs) ===== -->
<section id="certs" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-certificate"></i><span data-ar>الشهادات </span><span data-en>Certification Media (Images / PDFs)</span></h3>
    <div class="actions" data-guard>
      <label for="certInput" class="btn icon" title="رفع صور أو PDF"><i class="fa-solid fa-upload"></i></label>
      <input id="certInput" type="file" multiple accept="image/*,application/pdf" hidden>
    </div>
  </div>
  <div class="media-grid" id="certGrid"></div>
</section>

<!-- ===== Worksheets & Exams ===== -->
<section id="media-worksheets" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-file-pen"></i><span data-ar>أوراق العمل والاختبارات</span><span data-en>Worksheets & Exams</span></h3>
    <div class="actions" data-guard>
      <label for="wsInput" class="btn icon" title="رفع صور/فيديو/ملفات"><i class="fa-solid fa-upload"></i></label>
      <input id="wsInput" type="file" multiple accept="image/*,video/*,application/pdf" hidden>
    </div>
  </div>
  <div class="media-grid" id="wsGrid"></div>
</section>

<!-- ===== Activities ===== -->
<section id="media-activities" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-layer-group"></i><span data-ar>الأنشطة</span><span data-en>Activities</span></h3>
    <div class="actions" data-guard>
      <label for="actsInput" class="btn icon" title="رفع صور/فيديو/ملفات"><i class="fa-solid fa-upload"></i></label>
      <input id="actsInput" type="file" multiple accept="image/*,video/*,application/pdf" hidden>
    </div>
  </div>
  <div class="media-grid" id="actsGrid"></div>
</section>

<!-- ===== Schedule Lessons ===== -->
<section id="media-schedule" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-calendar-check"></i><span data-ar>جداول الدروس</span><span data-en>Schedule Lessons</span></h3>
    <div class="actions" data-guard>
      <label for="schedInput" class="btn icon" title="رفع صورة/ملف/فيديو"><i class="fa-solid fa-upload"></i></label>
      <input id="schedInput" type="file" multiple accept="image/*,video/*,application/pdf" hidden>
    </div>
  </div>
  <div class="media-grid" id="schedGrid"></div>
</section>

<!-- ===== Broadcast ===== -->
<section id="media-broadcast" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-tower-broadcast"></i><span data-ar>الإذاعة المدرسية / Broadcast</span><span data-en>Broadcast</span></h3>
    <div class="actions" data-guard>
      <label for="castInput" class="btn icon" title="رفع صور/فيديو/ملفات"><i class="fa-solid fa-upload"></i></label>
      <input id="castInput" type="file" multiple accept="image/*,video/*,application/pdf" hidden>
    </div>
  </div>
  <div class="media-grid" id="castGrid"></div>
</section>

<!-- ===== Support / تعزيز ===== -->
<section id="media-support" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-hands-holding-child"></i><span data-ar>تعزيز ودعم الطالبات</span><span data-en>Support & Ta'zeez</span></h3>
    <div class="actions" data-guard>
      <label for="supInput" class="btn icon" title="رفع صور/فيديو/ملفات"><i class="fa-solid fa-upload"></i></label>
      <input id="supInput" type="file" multiple accept="image/*,video/*,application/pdf" hidden>
    </div>
  </div>
  <div class="media-grid" id="supGrid"></div>
</section>

<!-- ===== Teaching Strategies (NEW set) ===== -->
<section id="skills" class="reveal">
  <div class="section-head">
    <h3 class="title"><i class="fa-solid fa-chalkboard-user"></i><span data-ar>مهارات واستراتيجيات التدريس</span><span data-en>Teaching Skills & Strategies</span></h3>
  </div>
  <div class="skills-grid">
    <div class="skill"><i class="fa-solid fa-flask-vial"></i><h4 data-ar>مختبر الدقيقة الواحدة</h4><h4 data-en>One-Minute Lab</h4><p data-ar>تجربة آمنة صغيرة لقياس مفهوم واحد مع بطاقة نتائج.</p><p data-en>Safe micro-experiment for a single idea + results card.</p></div>
    <div class="skill"><i class="fa-solid fa-diagram-project"></i><h4 data-ar>تعلم قائم على الظواهر</h4><h4 data-en>Phenomena-Based</h4><p data-ar>نبدأ بظاهرة قريبة ثم نبني التفسير خطوة بخطوة.</p><p data-en>Start from a real phenomenon; layer explanations.</p></div>
    <div class="skill"><i class="fa-solid fa-microscope"></i><h4 data-ar>دفتر الملاحظة العلمية</h4><h4 data-en>Science Notebook</h4><p data-ar>رسومات، جداول، فرضيات، بيانات، استنتاجات.</p><p data-en>Drawings, tables, hypotheses, data, conclusions.</p></div>
    <div class="skill"><i class="fa-solid fa-people-arrows"></i><h4 data-ar>تبادل الأدوار</h4><h4 data-en>Role-Swap</h4><p data-ar>طالبة تشرح وأخرى تتحقق من الدليل ثم تبادل.</p><p data-en>Explainer & evidence-checker pairs then swap.</p></div>
    <div class="skill"><i class="fa-solid fa-magnifying-glass-chart"></i><h4 data-ar>تحليل أخطاء شائعة</h4><h4 data-en>Common-Error Analysis</h4><p data-ar>نماذج أخطاء آمنة للنقاش لتثبيت المفاهيم.</p><p data-en>Discuss safe error models to cement ideas.</p></div>
    <div class="skill"><i class="fa-solid fa-chart-line"></i><h4 data-ar>مخطط بيانات سريع</h4><h4 data-en>Quick Data Plot</h4><p data-ar>رسم بسيط للبيانات بعد كل نشاط وربطه بالاستنتاج.</p><p data-en>Simple plotting after each activity, tied to claims.</p></div>
  </div>
</section>

</main>

<footer>
  <div class="container">
    <div data-ar> © جميع الحقوق محفوظة الأستاذة فاطمة</div>
    <div data-en class="en">© All rights reserved</div>
  </div>
</footer>

<!-- POPUP -->
<div id="overlay" role="dialog" aria-modal="true" aria-label="Viewer"></div>

<!-- ===== Auth Modal ===== -->
<div id="authModal" class="modal" aria-hidden="true">
  <div class="panel" style="background:#fff;border:1px solid var(--line);border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.2);padding:20px;min-width:320px;max-width:90vw">
    <h3 style="margin-top:0;color:#7a5328" data-ar>تسجيل الدخول</h3>
    <h3 style="margin-top:0;color:#7a5328" data-en>Sign in</h3>
    <input id="emailInput" type="email" class="input" placeholder="email@example.com" style="margin-bottom:8px" autocomplete="username">
    <input id="passwordInput" type="password" class="input" placeholder="password" style="margin-bottom:8px" autocomplete="current-password">
    <div class="cta" style="margin-top:12px;display:flex;gap:8px">
      <button id="signInBtn" class="btn" data-ar>تسجيل الدخول</button>
      <button id="signInBtn_en" class="btn" data-en>Sign in</button>
      <button id="closeAuth" class="btn secondary" data-ar>إغلاق</button>
      <button id="closeAuth_en" class="btn secondary" data-en>Close</button>
    </div>
    <p id="authMsg" class="note" style="margin-top:10px;color:#7a5328;font-weight:700"></p>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  /* ===== Language Toggle ===== */
  const root = document.body;
  document.getElementById('to-ar').onclick = ()=>{ root.classList.add('lang-ar'); root.classList.remove('lang-en'); };
  document.getElementById('to-en').onclick = ()=>{ root.classList.add('lang-en'); root.classList.remove('lang-ar'); };

  /* ===== Sections dropdown (floating) ===== */
  const sectionsPanel = document.createElement('div');
  sectionsPanel.id = 'sectionsPanel';
  sectionsPanel.style.cssText = 'position:fixed;inset-inline-end:16px;top:66px;background:#fff;border:1px solid var(--line);border-radius:14px;box-shadow:0 14px 40px rgba(110,73,34,.12);padding:10px;display:none;z-index:140;max-height:60vh;overflow:auto;min-width:240px';
  document.body.appendChild(sectionsPanel);

  const sectionsBtn = document.getElementById('sectionsBtn');
  const SECTIONS = [
    ['about','fa-book-open','نبذة','About'],
    ['vision','fa-eye','الرؤية','Vision'],
    ['objectives','fa-list-check','الأهداف','Objectives'],
    ['ksa-goals','fa-flag','أهداف التعليم','Saudi Goals'],
    ['mission','fa-bullseye','الرسالة','Mission'],
    ['ethics','fa-scale-balanced','الميثاق المهني','Charter'],
    ['cv','fa-id-card','السيرة الذاتية','CV'],
    ['certs','fa-certificate','الشهادات (صور/PDF)','Cert Media'],
    ['media-worksheets','fa-file-pen','أوراق العمل والاختبارات','Worksheets & Exams'],
    ['media-activities','fa-layer-group','الأنشطة','Activities'],
    ['media-schedule','fa-calendar-check','جداول الدروس','Schedule'],
    ['media-broadcast','fa-tower-broadcast','الإذاعة / Broadcast','Broadcast'],
    ['media-support','fa-hands-holding-child','تعزيز','Support'],
    ['skills','fa-chalkboard-user','استراتيجيات التدريس','Strategies']
  ];
  sectionsPanel.innerHTML = SECTIONS
    .map(([id,icon,ar,en])=>`<a href="#${id}" style="display:flex;align-items:center;gap:12px;padding:12px;border-radius:12px;color:#7a5328;font-weight:700"><i class="fa-solid ${icon}" style="color:#a98559"></i><span data-ar>${ar}</span><span data-en>${en}</span></a>`)
    .join('');
  sectionsPanel.querySelectorAll('a').forEach(a=>a.addEventListener('click',e=>{
    e.preventDefault(); sectionsPanel.style.display='none'; sectionsBtn.setAttribute('aria-expanded','false');
    document.getElementById(a.getAttribute('href').slice(1)).scrollIntoView({behavior:'smooth'});
  }));
  sectionsBtn.onclick = ()=>{
    const show = sectionsPanel.style.display!=='block';
    sectionsPanel.style.display = show ? 'block' : 'none';
    sectionsBtn.setAttribute('aria-expanded', show ? 'true' : 'false');
  };

  /* ===== Overlay / Viewer ===== */
  const overlay = document.getElementById('overlay');
  function lockBody(lock){ document.body.classList.toggle('no-scroll', !!lock); }
  function buildWindow({ title, icon = 'fa-rectangle-list', actions = [] }){
    overlay.innerHTML = `
      <div class="win" role="document">
        <div class="toolbar">
          <div class="title">
            <i class="fa-solid ${icon}"></i>
            <span title="${title || ''}">${title || ''}</span>
          </div>
          <div class="actions">
            ${actions.map(a =>
              a.href
                ? `<a class="btnx" ${a.download ? 'download' : ''} href="${a.href}" target="${a.target || '_self'}" rel="${a.rel || 'noopener'}" title="${a.label}">${a.label}</a>`
                : `<button class="btnx" data-action="${a.action}" title="${a.label}">${a.label}</button>`
            ).join('')}
            <button class="btnx" data-action="close" aria-label="Close">✕ إغلاق</button>
          </div>
        </div>
        <div class="content"><div class="content-inner"></div></div>
      </div>`;
    overlay.querySelector('[data-action="close"]').addEventListener('click', closeOverlay);
    overlay.addEventListener('click', (e)=>{ if (e.target === overlay) closeOverlay(); });
    document.addEventListener('keydown', escHandler);
    return { content: overlay.querySelector('.content-inner') };
  }
  function escHandler(ev){ if(ev.key === 'Escape'){ closeOverlay(); } }
  function showOverlay(){ overlay.classList.add('show'); lockBody(true); }
  function closeOverlay(){
    overlay.classList.remove('show'); overlay.innerHTML=''; lockBody(false);
    document.removeEventListener('keydown', escHandler);
  }
  window.closeOverlay = closeOverlay;

  function openImage(src,name=''){
    overlay.innerHTML=''; const actions=[{href:src,label:'Download',download:true},{href:src,label:'Open tab',target:'_blank',rel:'noopener'}];
    const { content } = buildWindow({ title:name||'Image', icon:'fa-image', actions });
    const img=new Image(); img.decoding='async'; img.loading='eager'; img.src=src; img.alt=name||'image'; img.style.maxHeight='84vh'; content.appendChild(img); showOverlay();
  }
  function openVideo(src,name=''){
    overlay.innerHTML=''; const actions=[{href:src,label:'Download',download:true},{href:src,label:'Open tab',target:'_blank',rel:'noopener'}];
    const { content } = buildWindow({ title:name||'Video', icon:'fa-film', actions });
    const v=document.createElement('video'); v.src=src; v.controls=true; v.playsInline=true; v.autoplay=true; v.style.maxHeight='84vh'; content.appendChild(v); showOverlay();
  }
  function openPDF(src,name=''){
    overlay.innerHTML=''; const actions=[{href:src,label:'Download',download:true},{href:src,label:'Open tab',target:'_blank',rel:'noopener'}];
    const { content } = buildWindow({ title:name||'PDF', icon:'fa-file-pdf', actions });
    const frame=document.createElement('iframe'); frame.src=src; content.appendChild(frame); showOverlay();
  }
  window.openImage = openImage; window.openVideo = openVideo; window.openPDF = openPDF;

  /* ===== Reveal on scroll ===== */
  const io = new IntersectionObserver((entries)=>{ entries.forEach(en=>{ if (en.isIntersecting){ en.target.classList.add('show'); io.unobserve(en.target); } }); }, { threshold:.12 });
  document.querySelectorAll('.reveal, .media-card, .skill').forEach(el=>io.observe(el));

  /* ===== Auth & Supabase ===== */
  const authModal = document.getElementById('authModal');
  const emailInput = document.getElementById('emailInput');
  const passwordInput = document.getElementById('passwordInput');
  const msg = document.getElementById('authMsg');
  const showAuth = show => { authModal.style.display = show ? 'flex' : 'none'; authModal.setAttribute('aria-hidden', show ? 'false' : 'true'); };
  const setMsg = t => { msg.textContent = t || ''; };
  function setGuardVisible(isAuthed){
    document.querySelectorAll('[data-guard]').forEach(el=>{ el.style.display = isAuthed ? 'flex' : 'none'; });
    document.getElementById('logoutBtn').style.display = isAuthed ? 'inline-block' : 'none';
  }
  document.getElementById('loginBtn').onclick = ()=> showAuth(true);
  document.getElementById('closeAuth').onclick = document.getElementById('closeAuth_en').onclick = ()=> showAuth(false);

  const SUPABASE_URL = 'https://znqjxqlrfslggjqaneho.supabase.co';
  const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpucWp4cWxyZnNsZ2dqcWFuZWhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5ODcyMjYsImV4cCI6MjA3NzU2MzIyNn0.Bd2a4yL24hMkFDykTIrEC5Jd-ZOHD90ckWm86w3-HEw';
  const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  const MEDIA_BUCKET = 'mida';
  const BASE = 'fatima1'; /* namespace for this teacher */

  const PATH = {
    CERT:  `${BASE}/certifications`,
    WS:    `${BASE}/worksheets`,
    ACT:   `${BASE}/activities`,
    SCHED: `${BASE}/schedule`,
    CAST:  `${BASE}/broadcast`,
    SUP:   `${BASE}/support`,
    CVIMG: `${BASE}/cvimg`
  };

  async function getUser(){ const { data } = await supabaseClient.auth.getUser(); return data?.user ?? null; }
  function requireUser(user){ if(!user){ showAuth(true); return false; } return true; }

  document.getElementById('signInBtn').onclick = document.getElementById('signInBtn_en').onclick = async ()=>{
    const email=(emailInput.value||'').trim(); const password=(passwordInput.value||'').trim();
    if(!email||!password){ setMsg('أدخلي الإيميل وكلمة المرور / Enter email & password'); return; }
    const { error } = await supabaseClient.auth.signInWithPassword({ email, password });
    if(error){ setMsg('خطأ: ' + error.message); return; }
    setMsg('تم تسجيل الدخول ✓'); showAuth(false);
    const user = await getUser(); setGuardVisible(!!user);
  };
  document.getElementById('logoutBtn').onclick = async ()=>{ await supabaseClient.auth.signOut(); setMsg('تم تسجيل الخروج'); setGuardVisible(false); };

  const publicUrl = path => supabaseClient.storage.from(MEDIA_BUCKET).getPublicUrl(path).data.publicUrl;

  async function listAt(path){
    const { data } = await supabaseClient.storage.from(MEDIA_BUCKET)
      .list(path, { limit:200, sortBy:{column:'created_at', order:'desc'} });
    return (data||[]).map(it=>({ name: it.name, path: `${path}/${it.name}`, url: publicUrl(`${path}/${it.name}`) }));
  }

  async function uploadManyAt(path, files){
    const user = await getUser(); if(!requireUser(user)) return;
    for(const f of files){
      const safe = (f.name || 'file').replace(/\s+/g,'_').toLowerCase();
      const fixed = /\.mb4$/i.test(safe) ? safe.replace(/\.mb4$/i,'.mp4') : safe;
      const to = `${path}/${Date.now()}_${fixed}`;
      await supabaseClient.storage.from(MEDIA_BUCKET).upload(to, f, { cacheControl:'3600', upsert:false });
    }
    loadAll();
  }

  async function uploadSingle(path, file){
    const user = await getUser(); if(!requireUser(user)) return;
    const existing = await listAt(path);
    if(existing.length){ await supabaseClient.storage.from(MEDIA_BUCKET).remove(existing.map(e=>e.path)); }
    const safe = (file.name || 'image').replace(/\s+/g,'_').toLowerCase();
    const to = `${path}/${Date.now()}_${safe}`;
    await supabaseClient.storage.from(MEDIA_BUCKET).upload(to, file, { cacheControl:'3600', upsert:false });
    loadAll();
  }

  async function removeFile(path){
    const user = await getUser(); if(!requireUser(user)) return;
    await supabaseClient.storage.from(MEDIA_BUCKET).remove([path]);
    loadAll();
  }

  function renderMixedGrid(container, files){
    if (!files.length){
      container.innerHTML = '<p style="grid-column:1/-1;color:#6f6154;margin:6px 2px">لا توجد عناصر حتى الآن.<span data-en> No items yet.</span></p>';
      return;
    }
    container.innerHTML = files.map(f=>{
      const isImg = /\.(png|jpe?g|webp|gif|svg)$/i.test(f.name);
      const isVid = /\.(mp4|m4v|webm|ogg|ogv|mov|3gp|3gpp|mkv|avi|mpeg|mpg)$/i.test(f.name);
      const isPdf = /\.pdf$/i.test(f.name);
      if (isImg){
        return `
          <div class="media-card reveal">
            <div class="media-actions" data-guard>
              <button class="icon-btn" data-del="${f.path}" title="حذف / Delete"><i class="fa-solid fa-trash"></i></button>
              <a class="icon-btn" href="${f.url}" download title="تنزيل / Download"><i class="fa-solid fa-download"></i></a>
            </div>
            <div class="media-thumb" data-kind="image">
              <img decoding="async" loading="lazy" src="${f.url}" alt="${f.name}" onclick="openImage('${f.url}','${f.name}')">
            </div>
          </div>`;
      }
      if (isVid){
        return `
          <div class="media-card reveal">
            <div class="media-actions" data-guard>
              <button class="icon-btn" data-del="${f.path}" title="حذف / Delete"><i class="fa-solid fa-trash"></i></button>
              <a class="icon-btn" href="${f.url}" download title="تنزيل / Download"><i class="fa-solid fa-download"></i></a>
            </div>
            <div class="media-thumb" data-kind="video" onclick="openVideo('${f.url}')">
              <video src="${f.url}" muted playsinline preload="metadata"></video>
            </div>
          </div>`;
      }
      if (isPdf){
        const name = f.name.replace(/_/g,' ');
        return `
          <div class="media-card reveal">
            <div class="media-actions" data-guard>
              <button class="icon-btn" data-del="${f.path}" title="حذف / Delete"><i class="fa-solid fa-trash"></i></button>
              <a class="icon-btn" href="${f.url}" download title="تنزيل / Download"><i class="fa-solid fa-download"></i></a>
            </div>
            <div class="media-thumb" data-kind="pdf" onclick="openPDF('${f.url}','${name}')">
              <div style="position:absolute;inset:0;display:grid;place-items:center;background:#fff">
                <div style="text-align:center">
                  <i class="fa-solid fa-file-pdf" style="font-size:36px;color:#7a5328"></i>
                  <div style="margin-top:6px;color:#7a5328;font-weight:800;max-width:90%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${name}</div>
                </div>
              </div>
            </div>
          </div>`;
      }
      return `
        <div class="media-card reveal">
          <div class="media-actions" data-guard>
            <button class="icon-btn" data-del="${f.path}" title="حذف / Delete"><i class="fa-solid fa-trash"></i></button>
            <a class="icon-btn" href="${f.url}" download title="تنزيل / Download"><i class="fa-solid fa-download"></i></a>
          </div>
          <div class="media-thumb" data-kind="file" style="aspect-ratio:3/2;display:grid;place-items:center;background:#fff">
            <div style="text-align:center;padding:18px">
              <i class="fa-solid fa-file" style="font-size:28px;color:#7a5328"></i>
              <div style="margin-top:8px;font-weight:800;color:#7a5328;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0 8px">${f.name}</div>
            </div>
          </div>
        </div>`;
    }).join('');

    container.querySelectorAll('[data-del]').forEach(btn=>{
      btn.addEventListener('click', (e)=>{ e.stopPropagation(); const path = btn.dataset.del;
        if (confirm('هل تريدين حذف هذا الملف؟ / Delete this file?')) removeFile(path);
      });
    });
    container.querySelectorAll('.reveal').forEach(el=>io.observe(el));
  }

  function renderSingleImage(holderEl, files, aspect='3/4'){
    holderEl.innerHTML = '';
    if(!files.length){ holderEl.style.display='none'; return; }
    holderEl.style.display='block';
    const f = files[0]; const url = f.url;
    const block = document.createElement('div');
    block.style.position='relative';
    block.innerHTML = `
      <div class="media-actions" data-guard style="position:absolute;top:8px;inset-inline-end:8px;display:flex;gap:6px;z-index:2">
        <button class="icon-btn" data-del="${f.path}" title="حذف / Delete"><i class="fa-solid fa-trash"></i></button>
        <a class="icon-btn" href="${url}" download title="تنزيل / Download"><i class="fa-solid fa-download"></i></a>
      </div>
      <div class="media-thumb" data-kind="image" style="aspect-ratio:${aspect}">
        <img decoding="async" src="${url}" alt="${f.name}" onclick="openImage('${url}','${f.name}')">
      </div>`;
    holderEl.appendChild(block);
    block.querySelector('[data-del]').addEventListener('click', ()=>{ if(confirm('Delete this image?')) removeFile(f.path); });
  }

  /* ===== Bind inputs ===== */
  const wsGrid   = document.getElementById('wsGrid');
  const actsGrid = document.getElementById('actsGrid');
  const schedGrid= document.getElementById('schedGrid');
  const castGrid = document.getElementById('castGrid');
  const supGrid  = document.getElementById('supGrid');
  const certGrid = document.getElementById('certGrid');
  const cvImgHolder = document.getElementById('cvImgHolder');

  document.getElementById('wsInput')   ?.addEventListener('change', e=>uploadManyAt(PATH.WS  , e.target.files));
  document.getElementById('actsInput') ?.addEventListener('change', e=>uploadManyAt(PATH.ACT , e.target.files));
  document.getElementById('schedInput')?.addEventListener('change', e=>uploadManyAt(PATH.SCHED, e.target.files));
  document.getElementById('castInput') ?.addEventListener('change', e=>uploadManyAt(PATH.CAST, e.target.files));
  document.getElementById('supInput')  ?.addEventListener('change', e=>uploadManyAt(PATH.SUP , e.target.files));
  document.getElementById('certInput') ?.addEventListener('change', e=>uploadManyAt(PATH.CERT, e.target.files));
  document.getElementById('cvImgInput')?.addEventListener('change', e=>{ if(e.target.files?.[0]) uploadSingle(PATH.CVIMG, e.target.files[0]); });

  async function loadAll(){
    const [ws, acts, sched, cast, sup, certs, cvimg, user] = await Promise.all([
      listAt(PATH.WS), listAt(PATH.ACT), listAt(PATH.SCHED), listAt(PATH.CAST),
      listAt(PATH.SUP), listAt(PATH.CERT), listAt(PATH.CVIMG), getUser()
    ]);
    renderMixedGrid(wsGrid, ws);
    renderMixedGrid(actsGrid, acts);
    renderMixedGrid(schedGrid, sched);
    renderMixedGrid(castGrid, cast);
    renderMixedGrid(supGrid,  sup);
    renderMixedGrid(certGrid, certs);
    renderSingleImage(cvImgHolder, cvimg, '3/4');
    setGuardVisible(!!user);
  }
  supabaseClient.auth.onAuthStateChange(async ()=>{ loadAll(); });
  loadAll();
});
</script>
</body>
</html>
